import{S as x,i as D,s as I,e as N,b as y,K as S,h as p,L as P,k as g,a as L,q as w,l as R,m as b,c as O,r as E,n as k,F as h,N as C}from"./index.9d1d7ce4.js";import{_ as V}from"./preload-helper.41c905a7.js";import{w as A}from"./index.9bd1d5f2.js";function j(o={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:s,onRegistered:i,onRegisteredSW:l,onRegisterError:c}=o;let r,u,_;const v=async(d=!0)=>{await u,await(_==null?void 0:_())};async function a(){if("serviceWorker"in navigator){const{Workbox:d}=await V(()=>import("./workbox-window.prod.es5.dc90f814.js"),[],import.meta.url);r=new d("/exercises/sw.js",{scope:"/exercises/",type:"classic"}),_=async()=>{await(r==null?void 0:r.messageSkipWaiting())};{let n=!1;const f=()=>{n=!0,r==null||r.addEventListener("controlling",m=>{m.isUpdate&&window.location.reload()}),t==null||t()};r.addEventListener("installed",m=>{typeof m.isUpdate>"u"?typeof m.isExternal<"u"?m.isExternal?f():!n&&(s==null||s()):m.isExternal?window.location.reload():!n&&(s==null||s()):m.isUpdate||s==null||s()}),r.addEventListener("waiting",f),r.addEventListener("externalwaiting",f)}r.register({immediate:e}).then(n=>{l?l("/exercises/sw.js",n):i==null||i(n)}).catch(n=>{c==null||c(n)})}}return u=a(),v}function q(o={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:s,onRegistered:i,onRegisteredSW:l,onRegisterError:c}=o,r=A(!1),u=A(!1),_=j({immediate:e,onOfflineReady(){u.set(!0),s==null||s()},onNeedRefresh(){r.set(!0),t==null||t()},onRegistered:i,onRegisteredSW:l,onRegisterError:c});return{needRefresh:r,offlineReady:u,updateServiceWorker:_}}function T(o){let e,t,s,i,l,c,r,u;function _(n,f){return n[1]?F:B}let v=_(o),a=v(o),d=o[0]&&U(o);return{c(){e=g("div"),t=g("div"),a.c(),s=L(),d&&d.c(),i=L(),l=g("button"),c=w("Close"),this.h()},l(n){e=R(n,"DIV",{class:!0,role:!0});var f=b(e);t=R(f,"DIV",{class:!0});var m=b(t);a.l(m),m.forEach(p),s=O(f),d&&d.l(f),i=O(f),l=R(f,"BUTTON",{class:!0});var W=b(l);c=E(W,"Close"),W.forEach(p),f.forEach(p),this.h()},h(){k(t,"class","message svelte-141ior1"),k(l,"class","svelte-141ior1"),k(e,"class","pwa-toast svelte-141ior1"),k(e,"role","alert")},m(n,f){y(n,e,f),h(e,t),a.m(t,null),h(e,s),d&&d.m(e,null),h(e,i),h(e,l),h(l,c),r||(u=C(l,"click",o[6]),r=!0)},p(n,f){v!==(v=_(n))&&(a.d(1),a=v(n),a&&(a.c(),a.m(t,null))),n[0]?d?d.p(n,f):(d=U(n),d.c(),d.m(e,i)):d&&(d.d(1),d=null)},d(n){n&&p(e),a.d(),d&&d.d(),r=!1,u()}}}function B(o){let e,t;return{c(){e=g("span"),t=w("New content available, click on reload button to update.")},l(s){e=R(s,"SPAN",{});var i=b(e);t=E(i,"New content available, click on reload button to update."),i.forEach(p)},m(s,i){y(s,e,i),h(e,t)},d(s){s&&p(e)}}}function F(o){let e,t;return{c(){e=g("span"),t=w("App ready to work offline")},l(s){e=R(s,"SPAN",{});var i=b(e);t=E(i,"App ready to work offline"),i.forEach(p)},m(s,i){y(s,e,i),h(e,t)},d(s){s&&p(e)}}}function U(o){let e,t,s,i;return{c(){e=g("button"),t=w("Reload"),this.h()},l(l){e=R(l,"BUTTON",{class:!0});var c=b(e);t=E(c,"Reload"),c.forEach(p),this.h()},h(){k(e,"class","svelte-141ior1")},m(l,c){y(l,e,c),h(e,t),s||(i=C(e,"click",o[7]),s=!0)},p:S,d(l){l&&p(e),s=!1,i()}}}function K(o){let e,t=o[2]&&T(o);return{c(){t&&t.c(),e=N()},l(s){t&&t.l(s),e=N()},m(s,i){t&&t.m(s,i),y(s,e,i)},p(s,[i]){s[2]?t?t.p(s,i):(t=T(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:S,o:S,d(s){t&&t.d(s),s&&p(e)}}}function M(o,e,t){let s,i,l;const{needRefresh:c,updateServiceWorker:r,offlineReady:u}=q({onRegistered(a){console.log(`SW Registered: ${a}`)},onRegisterError(a){console.log("SW registration error",a)}});P(o,c,a=>t(0,i=a)),P(o,u,a=>t(1,l=a));const _=()=>{u.set(!1),c.set(!1)},v=()=>r(!0);return o.$$.update=()=>{o.$$.dirty&3&&t(2,s=l||i)},[i,l,s,c,r,u,_,v]}class J extends x{constructor(e){super(),D(this,e,M,K,I,{})}}export{J as default};
