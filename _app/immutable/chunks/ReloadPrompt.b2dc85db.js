import{S as I,i as x,s as D,e as N,b as w,K as S,h as p,L as P,k as g,a as L,q as y,l as R,m as k,c as O,r as E,n as b,F as h,N as U}from"./index.9d1d7ce4.js";import{_ as V}from"./preload-helper.41c905a7.js";import{w as A}from"./index.9bd1d5f2.js";function j(i={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:s,onRegistered:o,onRegisteredSW:l,onRegisterError:c}=i;let a,u,_;const v=async(d=!0)=>{await u,await(_==null?void 0:_())};async function r(){if("serviceWorker"in navigator){const{Workbox:d}=await V(()=>import("./workbox-window.prod.es5.dc90f814.js"),[],import.meta.url);a=new d("/exercises/sw.js",{scope:"/exercises/",type:"classic"}),_=async()=>{await(a==null?void 0:a.messageSkipWaiting())};{let n=!1;const f=()=>{n=!0,a==null||a.addEventListener("controlling",m=>{m.isUpdate&&window.location.reload()}),t==null||t()};a.addEventListener("installed",m=>{typeof m.isUpdate>"u"?typeof m.isExternal<"u"?m.isExternal?f():!n&&(s==null||s()):m.isExternal?window.location.reload():!n&&(s==null||s()):m.isUpdate||s==null||s()}),a.addEventListener("waiting",f),a.addEventListener("externalwaiting",f)}a.register({immediate:e}).then(n=>{l?l("/exercises/sw.js",n):o==null||o(n)}).catch(n=>{c==null||c(n)})}}return u=r(),v}function q(i={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:s,onRegistered:o,onRegisteredSW:l,onRegisterError:c}=i,a=A(!1),u=A(!1),_=j({immediate:e,onOfflineReady(){u.set(!0),s==null||s()},onNeedRefresh(){a.set(!0),t==null||t()},onRegistered:o,onRegisteredSW:l,onRegisterError:c});return{needRefresh:a,offlineReady:u,updateServiceWorker:_}}function C(i){let e,t,s,o,l,c,a,u;function _(n,f){return n[1]?F:B}let v=_(i),r=v(i),d=i[0]&&T(i);return{c(){e=g("div"),t=g("div"),r.c(),s=L(),d&&d.c(),o=L(),l=g("button"),c=y("Close"),this.h()},l(n){e=R(n,"DIV",{class:!0,role:!0});var f=k(e);t=R(f,"DIV",{class:!0});var m=k(t);r.l(m),m.forEach(p),s=O(f),d&&d.l(f),o=O(f),l=R(f,"BUTTON",{class:!0});var W=k(l);c=E(W,"Close"),W.forEach(p),f.forEach(p),this.h()},h(){b(t,"class","message svelte-141ior1"),b(l,"class","svelte-141ior1"),b(e,"class","pwa-toast svelte-141ior1"),b(e,"role","alert")},m(n,f){w(n,e,f),h(e,t),r.m(t,null),h(e,s),d&&d.m(e,null),h(e,o),h(e,l),h(l,c),a||(u=U(l,"click",i[6]),a=!0)},p(n,f){v!==(v=_(n))&&(r.d(1),r=v(n),r&&(r.c(),r.m(t,null))),n[0]?d?d.p(n,f):(d=T(n),d.c(),d.m(e,o)):d&&(d.d(1),d=null)},d(n){n&&p(e),r.d(),d&&d.d(),a=!1,u()}}}function B(i){let e,t;return{c(){e=g("span"),t=y("New content available, click on reload button to update.")},l(s){e=R(s,"SPAN",{});var o=k(e);t=E(o,"New content available, click on reload button to update."),o.forEach(p)},m(s,o){w(s,e,o),h(e,t)},d(s){s&&p(e)}}}function F(i){let e,t;return{c(){e=g("span"),t=y("App ready to work offline")},l(s){e=R(s,"SPAN",{});var o=k(e);t=E(o,"App ready to work offline"),o.forEach(p)},m(s,o){w(s,e,o),h(e,t)},d(s){s&&p(e)}}}function T(i){let e,t,s,o;return{c(){e=g("button"),t=y("Reload"),this.h()},l(l){e=R(l,"BUTTON",{class:!0});var c=k(e);t=E(c,"Reload"),c.forEach(p),this.h()},h(){b(e,"class","svelte-141ior1")},m(l,c){w(l,e,c),h(e,t),s||(o=U(e,"click",i[7]),s=!0)},p:S,d(l){l&&p(e),s=!1,o()}}}function K(i){let e,t=i[2]&&C(i);return{c(){t&&t.c(),e=N()},l(s){t&&t.l(s),e=N()},m(s,o){t&&t.m(s,o),w(s,e,o)},p(s,[o]){s[2]?t?t.p(s,o):(t=C(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:S,o:S,d(s){t&&t.d(s),s&&p(e)}}}function M(i,e,t){let s,o,l;const{needRefresh:c,updateServiceWorker:a,offlineReady:u}=q({onRegistered(r){r&&setInterval(()=>{console.log("Checking for sw update"),r.update()},2e4),console.log(`SW Registered: ${r}`)},onRegisterError(r){console.log("SW registration error",r)}});P(i,c,r=>t(0,o=r)),P(i,u,r=>t(1,l=r));const _=()=>{u.set(!1),c.set(!1)},v=()=>a(!0);return i.$$.update=()=>{i.$$.dirty&3&&t(2,s=l||o)},[o,l,s,c,a,u,_,v]}class J extends I{constructor(e){super(),x(this,e,M,K,D,{})}}export{J as default};
